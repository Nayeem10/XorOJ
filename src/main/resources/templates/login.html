<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login â€” XorOJ</title>

  <!-- Tailwind (CDN for dev) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind config to define brand colors (optional)
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            accent: { DEFAULT: '#4f46e5' }, // indigo-ish
            accentDark: '#8b5cf6',
            cardLight: '#f6f7f9',
            cardDark: '#101828',
            borderLight: '#e2e8f0',
            borderDark: '#1f2a44'
          },
          boxShadow: {
            brand: '0 8px 24px 0 rgba(79,70,229,0.25)'
          }
        }
      }
    };
  </script>

  <!-- Theme bootstrap: system preference, then saved preference -->
  <script>
    (function () {
      const saved = localStorage.getItem('xoroj-theme');
      const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      const useDark = saved ? saved === 'dark' : prefersDark;
      if (useDark) document.documentElement.classList.add('dark');
    })();
    function toggleTheme() {
      const html = document.documentElement;
      const nextIsDark = !html.classList.contains('dark');
      html.classList.toggle('dark', nextIsDark);
      localStorage.setItem('xoroj-theme', nextIsDark ? 'dark' : 'light');
    }
  </script>
</head>

<body class="min-h-screen bg-white text-slate-900 dark:bg-[#0b1220] dark:text-slate-200 flex flex-col">
  <!-- NAVBAR -->
  <header class="sticky top-0 z-50 backdrop-blur bg-white/80 dark:bg-[#0b1220]/70 border-b border-slate-200 dark:border-[#1f2a44]">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-3">
      <a href="/" class="flex items-center gap-2 font-extrabold text-lg">
        <span class="inline-flex w-7 h-7 rounded-lg items-center justify-center text-white"
              style="background: linear-gradient(135deg, #4f46e5, #06b6d4); box-shadow: 0 6px 16px rgba(79,70,229,.35);">
          X
        </span>
        <span>XorOJ</span>
      </a>

      <div class="flex-1"></div>

      <div class="flex items-center gap-2">
        <button type="button"
                class="px-3 py-2 rounded-lg border border-slate-200 dark:border-[#1f2a44] bg-slate-50 dark:bg-[#101828]"
                aria-label="Toggle theme" onclick="toggleTheme()">ðŸŒ“</button>

      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="flex-1">
    <div class="max-w-6xl mx-auto px-4">
      <!-- Centered login card -->
      <div class="grid place-items-center py-10 sm:py-16">
        <div class="w-full max-w-md">
          <div class="rounded-2xl border border-slate-200 dark:border-[#1f2a44] bg-[var(--cardLight)] dark:bg-[var(--cardDark)] bg-white dark:bg-[#101828] p-6 sm:p-8 shadow">
            <div class="mb-6">
              <h1 class="text-2xl font-bold">Welcome back</h1>
              <p class="text-sm text-slate-600 dark:text-slate-400 mt-1">Log in to continue to XorOJ.</p>
            </div>

            <!-- Alerts / messages -->
            <div class="space-y-2 mb-4">
              <!-- Error message from Spring Security -->
              <div th:if="${param.error}"
                   class="rounded-lg border border-red-300/60 bg-red-50 text-red-700 dark:bg-red-900/30 dark:text-red-200 dark:border-red-800 px-3 py-2 text-sm">
                <span th:text="${session['SPRING_SECURITY_LAST_EXCEPTION'] != null ? session['SPRING_SECURITY_LAST_EXCEPTION'].message : 'Invalid credentials'}">
                  Invalid credentials
                </span>
              </div>

              <!-- Logged out -->
              <div th:if="${param.loggedOut}"
                   class="rounded-lg border border-emerald-300/60 bg-emerald-50 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-200 dark:border-emerald-800 px-3 py-2 text-sm">
                You have been logged out.
              </div>

              <!-- Signup success hint (set this model attr from your signup controller) -->
              <div th:if="${signupSuccess}"
                   class="rounded-lg border border-indigo-300/60 bg-indigo-50 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-200 dark:border-indigo-800 px-3 py-2 text-sm">
                Account created. Please sign in.
              </div>
            </div>

            <!-- Login form -->
            <form method="post" action="/req/login" class="space-y-5">
              <!-- Username -->
              <div>
                <label for="username" class="block text-sm font-semibold mb-1">Username</label>
                <div class="relative">
                  <input id="username" name="username" type="text" required
                         class="w-full rounded-xl border border-slate-300 dark:border-[#1f2a44] bg-white dark:bg-[#0b1220] px-4 py-2.5 outline-none focus:ring-2 focus:ring-accent/50 dark:focus:ring-accentDark/50"
                         placeholder="Enter your username" />
                </div>
              </div>

              <!-- Password -->
              <div>
                <label for="password" class="block text-sm font-semibold mb-1">Password</label>
                <div class="relative">
                  <input id="password" name="password" type="password" required
                         class="w-full rounded-xl border border-slate-300 dark:border-[#1f2a44] bg-white dark:bg-[#0b1220] px-4 py-2.5 outline-none focus:ring-2 focus:ring-accent/50 dark:focus:ring-accentDark/50"
                         placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" />
                </div>
              </div>

              <div class="flex items-center justify-between">
                <a href="#" class="text-sm text-indigo-600 dark:text-indigo-400 hover:underline">Forgot password?</a>
                <!-- If you later enable remember-me in Spring Security -->
                <!-- <label class="text-sm flex items-center gap-2">
                  <input type="checkbox" name="remember-me" class="rounded border-slate-300 dark:border-[#1f2a44]" />
                  Remember me
                </label> -->
              </div>

              <button type="submit"
                      class="w-full inline-flex items-center justify-center rounded-xl bg-accent text-white font-semibold px-4 py-2.5 shadow-brand hover:brightness-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-accent/60 dark:focus:ring-offset-[#0b1220]">
                Log in
              </button>
            </form>

            <div class="mt-6 text-sm text-slate-600 dark:text-slate-400 text-center">
              Donâ€™t have an account?
              <a href="/signup" class="text-indigo-600 dark:text-indigo-400 font-semibold hover:underline">Sign up</a>
            </div>
          </div>

          <!-- Small promo / links row to match home vibe -->
         
        </div>
      </div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="border-t border-slate-200 dark:border-[#1f2a44] py-6">
    <div class="max-w-6xl mx-auto px-4 text-sm text-slate-600 dark:text-slate-400">
      Â© <span th:text="${#dates.format(#dates.createNow(), 'yyyy')}">2025</span> XorOJ. All rights reserved.
    </div>
  </footer>
</body>
</html>
